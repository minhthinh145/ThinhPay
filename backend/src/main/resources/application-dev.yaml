spring:
  application:
    name: thinhpay-backend

  datasource:
    url: jdbc:postgresql://${DB_HOST}:${DB_PORT:5432}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  liquibase:
    enabled: true
    change-log: classpath:db/changelog/db.changelog-master.yaml
  docker:
    compose:
      enabled: false
  cache:
    type: redis
    redis:
      time-to-live: 3600000 # 1 hour in milliseconds

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      timeout: 2000ms

  # Email Configuration (SMTP Gmail)
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000

# JWT Configuration
jwt:
  secret: ${JWT_SECRET:thinhpay-secret-key-change-this-in-production-minimum-512-bits-for-security}
  access-token-validity: 900000    # 15 minutes (in milliseconds)
  refresh-token-validity: 604800000 # 7 days (in milliseconds)

# ThinhPay Application Configuration
thinhpay:
  app:
    name: ThinhPay
    frontend-url: http://localhost:4200
  email:
    from: ${MAIL_USERNAME}
    from-name: ThinhPay Support

server:
  port: 8080

# Spring Boot Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
      base-path: /actuator
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true
  metrics:
    export:
      prometheus:
        enabled: true
    tags:
      application: ${spring.application.name}
  info:
    env:
      enabled: true

# Application Info
info:
  app:
    name: ThinhPay Backend
    description: Digital Payment Platform
    version: 0.0.1-SNAPSHOT
    phase: Phase 4 - Monitoring

# Logging Configuration
logging:
  level:
    com.thinhpay.backend.shared.infrastructure.security.RateLimitingFilter: DEBUG
    com.thinhpay.backend.shared.infrastructure.config.RateLimitConfig: DEBUG

# Rate Limiting Configuration
rate-limit:
  limits:
    - path: /api/v1/auth/register
      capacity: 5
      tokens: 5
      interval: 1h
    - path: /api/v1/auth/login
      capacity: 10
      tokens: 10
      interval: 15m
    - path: /api/v1/auth/generate-otp
      capacity: 3
      tokens: 3
      interval: 1h
    - path: /api/v1/auth/resend-otp
      capacity: 3
      tokens: 3
      interval: 1h
  default-limit:
    capacity: 100
    tokens: 100
    interval: 1m

